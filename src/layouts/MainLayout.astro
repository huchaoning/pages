---
import "../styles/global.css";
import { Icon } from "astro-icon/components";

const { title = "Chao-Ning Hu" } = Astro.props;
const NAME = "Chao-Ning Hu";

export const slateLinear =
  "inline-block bg-linear-to-br from-slate-900 to-slate-500 bg-clip-text text-transparent";
export const hoverSlateLinear =
  "inline-block hover:bg-linear-to-br hover:from-slate-900 hover:to-slate-500 hover:bg-clip-text hover:text-transparent";
export const glassEffect =
  "bg-black/5 backdrop-blur-sm border border-white/50 shadow-xl inset-shadow-xl";
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{title}</title>
  </head>

  <body class="bg-[#fbfbfd] text-slate-900 font-sans antialiased">
    <div class="fixed inset-0 -z-10 overflow-hidden pointer-events-none">
      <div
        class="absolute top-0 right-0 w-[60%] h-[60%] bg-[#f5b3bc23] rounded-full blur-[120px]"
      >
      </div>
      <div
        class="absolute bottom-0 left-0 w-[50%] h-[50%] bg-[#845ec223] rounded-full blur-[100px]"
      >
      </div>
    </div>

    <nav
      id="main-nav"
      class="fixed top-6 inset-x-0 z-50 flex justify-center px-6 transition-all duration-500 ease-in-out"
    >
      <div
        class={`flex items-center justify-between w-full max-w-2xl px-6 py-3 rounded-full ${glassEffect}`}
      >
        <a href="/" class={`font-bold text-sm hover:opacity-70 ${slateLinear}`}>
          {NAME}
        </a>

        <div
          class="flex gap-6 text-[10px] font-black uppercase tracking-widest text-slate-400"
        >
          <a href="/about" class={`${hoverSlateLinear}`}>about</a>
          <a href="/posts" class={`${hoverSlateLinear}`}>posts</a>
        </div>
      </div>
      <button
        id="search-button"
        class={`flex items-center justify-between px-3 py-3 ml-3 rounded-full ${glassEffect}`}
        aria-label="Search"
      >
        <Icon name="ri:search-line" class="w-4.5 h-4.5 text-slate-400" />
      </button>
    </nav>

    <slot />
  </body>

  <style is:global>
    .nav-hidden {
      transform: translateY(-150%) scale(0.9);
      pointer-events: none;
    }
  </style>

  <script is:inline>
    let lastScrollY = window.scrollY;
    let scrollUpAmount = 0;
    const nav = document.getElementById("main-nav");
    const threshold = 60;

    window.addEventListener(
      "scroll",
      () => {
        const currentScrollY = window.scrollY;

        if (currentScrollY <= 0) {
          nav.classList.remove("nav-hidden");
          lastScrollY = 0;
          scrollUpAmount = 0;
          return;
        }

        const maxScroll =
          document.documentElement.scrollHeight - window.innerHeight;
        if (currentScrollY >= maxScroll) {
          lastScrollY = currentScrollY;
          return;
        }

        const diff = lastScrollY - currentScrollY;

        if (currentScrollY > lastScrollY) {
          scrollUpAmount = 0;
          if (currentScrollY > 100) {
            nav.classList.add("nav-hidden");
          }
        } else {
          scrollUpAmount += diff;
          if (scrollUpAmount > threshold || currentScrollY < 10) {
            nav.classList.remove("nav-hidden");
          }
        }

        lastScrollY = currentScrollY;
      },
      { passive: true },
    );
  </script>
</html>
